/mnt/AIWorkSpace/work/TEST_DFINE_COUNT/D-FINE-master/tools/deployment/export_onnx.py:71: UserWarning: # 'dynamic_axes' is not recommended when dynamo=True, and may lead to 'torch._dynamo.exc.UserError: Constraints violated.' Supply the 'dynamic_shapes' argument instead if export is unsuccessful.
  torch.onnx.export(
W1213 18:12:01.095000 80468 torch/onnx/_internal/exporter/_compat.py:114] Setting ONNX exporter to use operator set version 18 because the requested opset_version 16 is a lower version than we have implementations for. Automatic version conversion will be performed, which may not be successful at converting to the requested version. If version conversion is unsuccessful, the opset version of the exported model will be kept at 18. Please consider setting opset_version >=18 to leverage latest ONNX features
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759] failed while attempting to run meta for aten.mul_.Tensor
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759] Traceback (most recent call last):
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 2755, in _dispatch_impl
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     r = func(*args, **kwargs)
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]         ^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_ops.py", line 841, in __call__
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     return self._op(*args, **kwargs)
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]            ^^^^^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 4140, in meta_binop_inplace
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     check_inplace_broadcast(self.shape, other.shape)
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 97, in check_inplace_broadcast
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     broadcasted_shape = tuple(_broadcast_shapes(self_shape, *args_shape))
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_refs/__init__.py", line 436, in _broadcast_shapes
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     torch._check(
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1695, in _check
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     _check_with(RuntimeError, cond, message)
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1677, in _check_with
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759]     raise error_type(message_evaluated)
E1213 18:12:06.700000 80468 torch/_subclasses/fake_tensor.py:2759] RuntimeError: Attempting to broadcast a dimension of length s31 at -3! Mismatching argument at index 1 had torch.Size([s31, 1, 4]); but expected shape should be broadcastable to [s34, 300, 4]
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0] failed while attempting to run meta for aten.mul_.Tensor
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0] Traceback (most recent call last):
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 2755, in _dispatch_impl
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     r = func(*args, **kwargs)
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]         ^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_ops.py", line 841, in __call__
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     return self._op(*args, **kwargs)
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]            ^^^^^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 4140, in meta_binop_inplace
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     check_inplace_broadcast(self.shape, other.shape)
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 97, in check_inplace_broadcast
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     broadcasted_shape = tuple(_broadcast_shapes(self_shape, *args_shape))
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_refs/__init__.py", line 436, in _broadcast_shapes
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     torch._check(
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1695, in _check
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     _check_with(RuntimeError, cond, message)
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]   File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1677, in _check_with
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0]     raise error_type(message_evaluated)
E1213 18:12:10.603000 80468 torch/_subclasses/fake_tensor.py:2759] [0/0] RuntimeError: Attempting to broadcast a dimension of length s31 at -3! Mismatching argument at index 1 had torch.Size([s31, 1, 4]); but expected shape should be broadcastable to [s34, 300, 4]
E1213 18:12:10.637000 80468 torch/export/_trace.py:1142] always_classified is unsupported.
E1213 18:12:10.638000 80468 torch/export/_trace.py:1142] always_classified is unsupported.
Traceback (most recent call last):
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 118, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 210, in _capture
    return torch.export.export(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/__init__.py", line 311, in export
    raise e
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/__init__.py", line 277, in export
    return _export(
           ^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1163, in wrapper
    raise e
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1129, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 2255, in _export
    ep = _export_for_training(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1163, in wrapper
    raise e
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1129, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 2071, in _export_for_training
    export_artifact = export_func(
                      ^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 2002, in _non_strict_export
    aten_export_artifact = _to_aten_func(  # type: ignore[operator]
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1793, in _export_to_aten_ir_make_fx
    gm, graph_signature = transform(_make_fx_helper)(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1922, in _aot_export_non_strict
    gm, sig = aot_export(wrapped_mod, args, kwargs=kwargs, **flags)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1706, in _make_fx_helper
    gm = make_fx(
         ^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 2429, in wrapped
    return make_fx_tracer.trace(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 2356, in trace
    return self._trace_inner(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 2318, in _trace_inner
    t = dispatch_trace(
        ^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1303, in dispatch_trace
    graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1908, in trace
    res = super().trace(root, concrete_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 868, in trace
    (self.create_arg(fn(*args)),),
                     ^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1361, in wrapped
    out = f(*tensors)  # type:ignore[call-arg]
          ^^^^^^^^^^^
  File "<string>", line 1, in <lambda>
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1593, in wrapped_fn
    return tuple(flat_fn(*args))
                 ^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_functorch/_aot_autograd/utils.py", line 187, in flat_fn
    tree_out = fn(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_functorch/_aot_autograd/graph_capture_wrappers.py", line 1354, in functional_call
    out = mod(*args[params_len:], **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 843, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1997, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 560, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 836, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/export/_trace.py", line 1906, in forward
    tree_out = mod(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 843, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1997, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 560, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 836, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/AIWorkSpace/work/TEST_DFINE_COUNT/D-FINE-master/tools/deployment/export_onnx.py", line 53, in forward
    outputs = self.postprocessor(outputs, orig_target_sizes)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 843, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1997, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 560, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/_symbolic_trace.py", line 836, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/AIWorkSpace/work/TEST_DFINE_COUNT/D-FINE-master/tools/deployment/../../src/zoo/dfine/postprocessor.py", line 44, in forward
    bbox_pred *= orig_target_sizes.repeat(1, 2).unsqueeze(1)
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1409, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1479, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_export/non_strict_utils.py", line 1066, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_ops.py", line 962, in handler
    return torch._library.utils.handle_dispatch_mode(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_library/utils.py", line 286, in handle_dispatch_mode
    return curr_mode.__torch_dispatch__(op_overload, overload_types, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/utils/_stats.py", line 28, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 1534, in __torch_dispatch__
    return proxy_call(self, func, self.pre_dispatch, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/fx/experimental/proxy_tensor.py", line 994, in proxy_call
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/utils/_stats.py", line 28, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 1376, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 2096, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 1511, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_subclasses/fake_tensor.py", line 2755, in _dispatch_impl
    r = func(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_ops.py", line 841, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 4140, in meta_binop_inplace
    check_inplace_broadcast(self.shape, other.shape)
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_meta_registrations.py", line 97, in check_inplace_broadcast
    broadcasted_shape = tuple(_broadcast_shapes(self_shape, *args_shape))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/_refs/__init__.py", line 436, in _broadcast_shapes
    torch._check(
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1695, in _check
    _check_with(RuntimeError, cond, message)
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/__init__.py", line 1677, in _check_with
    raise error_type(message_evaluated)
RuntimeError: Attempting to broadcast a dimension of length s31 at -3! Mismatching argument at index 1 had torch.Size([s31, 1, 4]); but expected shape should be broadcastable to [s34, 300, 4]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/AIWorkSpace/work/TEST_DFINE_COUNT/D-FINE-master/tools/deployment/export_onnx.py", line 128, in <module>
    main(args)
  File "/mnt/AIWorkSpace/work/TEST_DFINE_COUNT/D-FINE-master/tools/deployment/export_onnx.py", line 71, in main
    torch.onnx.export(
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/__init__.py", line 296, in export
    return _compat.export_compat(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_compat.py", line 143, in export_compat
    onnx_program = _core.export(
                   ^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_flags.py", line 23, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/skchen/venv/deim/lib/python3.11/site-packages/torch/onnx/_internal/exporter/_core.py", line 1385, in export
    raise _errors.TorchExportError(
torch.onnx._internal.exporter._errors.TorchExportError: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'RuntimeError'>: Attempting to broadcast a dimension of length s31 at -3! Mismatching argument at index 1 had torch.Size([s31, 1, 4]); but expected shape should be broadcastable to [s34, 300, 4]

(Refer to the full stack trace above for more information.)
